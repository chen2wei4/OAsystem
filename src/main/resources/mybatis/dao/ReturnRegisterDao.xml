<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 车辆申请管理 -->
<mapper namespace="com.woniuxy.oasystem.dao.ReturnRegisterDao">
	<!-- 分页查询 -->
	<select id="findAllByPage" resultType="ReturnRegister">
		select * from return_register where flag = 1
		<include refid="conditionSql"/>
		limit #{pageIndex},#{pageSize}
	</select>
	<!-- 总条数-->
	<select id="findAllByPageCount" resultType="int">
		select count(*) from return_register 
		where flag = 1
		<include refid="conditionSql"/>
	</select>
	<!-- 模糊查询条件 -->
	<sql id="conditionSql">
			<if test="rr.empId!= null and rr.empId!=''">
				and emp_id like '%' #{rr.empId} '%'
			</if>
			<if test="rr.license!= null and rr.license!=''">
				and license like '%' #{rr.license} '%'
			</if>
			<if test="rr.returnTime!= null and rr.returnTime!=''">
				and return_time like '%' #{rr.returnTime} '%'
			</if>
			<if test="rr.maintenance!= null and rr.maintenance!=''">
				and maintenance like '%' #{rr.maintenance} '%'
			</if>
			<if test="rr.place!= null and rr.place!=''">
				and place like '%' #{rr.place} '%'
			</if>
	</sql>
	<!-- 根据rrId删除 -->
	<update id="deleteByRrId">
		update return_register set flag = 0 where rr_id = #{rrId}
	</update>
	<!-- 根据rrId修改 -->
	<update id="updateByRrId">
		update return_register set 
		license=#{rr.license},emp_id=#{rr.empId},return_time=#{rr.returnTime},
		maintenance=#{rr.maintenance},place=#{rr.place},mileage=#{rr.mileage},oil=#{rr.oil},
		parking_place=#{rr.parkingPlace}
		where rr_id = #{rr.rrId}
	</update>
	<!-- 添加 -->
	<insert id="insert">
		insert into return_register (license,emp_id,return_time,maintenance,place,mileage,oil,parking_place) 
		values (#{rr.license},#{rr.empId},#{rr.returnTime},#{rr.maintenance},#{rr.place},#{rr.mileage},#{rr.oil},#{rr.parkingPlace})
	</insert>
</mapper>